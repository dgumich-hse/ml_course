# **Часть 1 | EDA и визуализация**

### **Задание 1**
1) Загружен дата с информацией по машинам
2) Изучена структура дата сета:
- Количество строк, столбцов и их тип данных
- Проверка наличия пропусков
- Проверка наличия дубликатов (полных, то есть по всем строкам)
3) С помощью библиотеки ydata-profilling был построен profile-dashboard

### **Задание 2**
1) Проверка наличия дубликатов (без столбца с целевой переменной)
2) Удаление данных дубликатов
3) Обновление индексов, после удаление дублирующих строк

### **Задание 3**
1) Обработка категориальных столбцов mileage, engine, max_power:
- Оставление только чисел и перевод их в float
- Заполнение пропусков (в train и test) медианным значением, рассчитанным на train
2) Удаление столбца torque из дата фреймов train и test

### **Задание 4**
1) Обработка категориального столбца seats:
- Перевод из строкового значения в int
- Заполнение пропусков медианным значением
2) Обработка столбца engine - перевод из float в int

### **Задание 5**
1) Посчитаны и проанализированы числовые характеристики (train и test)
2) Посчитаны и проанализированы категориальные характеристики 

### **Задание 6**
1) С помощью библиотеки seaborn были построены графики попарного распределения числовых признаков
2) Выделены признаки, которые имеют корреляцию/связь с целевой переменной

### **Задание 7**
1) Построена тепловая карта на основе коэффициентов Пирсона
2) Выделены признаки, которые имеют самую сильную и самую слабую корреляцию 

После выполнения части 1 мы получили обработанные дата сеты (убраны дубликаты, заполнены пропуски, 
частично обработаны категориальные признаки), проанализировали количество и качество данных, 
сделали первые выводы о зависимости между собой и целевой переменной, а так же визуализировали наши шаги

# **Часть 2 | Модель только на вещественных признаках**

### **Задание 8**
В рамках данного задания из дата сетов (train/test) удалены категориальные столбцы + целевая переменная 

### **Задание 9**
1) Обучена самая стандартная линейная модель - LinearRegression
2) Получены метрики mse: 233543294967.03 и r2: 0.59. Такие показатели говорят о невысокой точности модели

### **Задание 10**
1) Добавлена стандартизация признаков при помощи StandardScaler. Обучение было только на train
2) На новых, стандартизированных данных была обучена новая стандартная модель LinearRegression.
3) Полученные метрики сопоставимы с первой моделью (mse: 233543294967.02 и r2: 0.59), 
   а значит, стандартизация особо не помогла.

### **Задание 11**
Проверены коэффициенты у моделей со стандартизацией и без. Выделен самый важный признак для каждой модели

### **Задание 12**
1) Обучена линейная регрессия с регулязацией L1 (Lasso)
2) Метрики качества получились такие же, как у первых двух моделей (mse: 233543964242.36 и r2: 0.59)
3) Зануление весов не произошло

### **Задание 13 Финальный рывок**
1) С помощью GridSearchCV были перебраны гиперпараметры (коэффициент alpha) у модели Lasso
2) Лучший результат был достигнут при alpha=10000, при этом произошло зануление веса у признака seats. 
3) С помощью GridSearchCV были перебраны гиперпараметры (коэффициент alpa и l1_ratio) у модели ElasticNet 
4) Лучший результат был достигнут при alpha=1.0 и l1_ration=0.9

# **Часть 3| Добавляем категориальные фичи**

### **Задание 14**
1) Удалён столбец name

### **Задание 15**
1) Категориальные столбцы + seats были закодирован с помощью OneHotEncoding (OneHotEncoder из sklearn)

### **Задание 16**
1) С помощью GridSearchCV были перебраны гиперпараметры (коэффициент alpha) у модели Ridge
2) Лучший результат был достигнут при alpha=1, r2 стал 0.62.

### **Задание 17**
1) Реализована своя бизнес метрика (процент предсказанных значений, которые отклоняются от фактического не более чем на 10%)
2) Рассчитаны показатели для всех моделей, которые были обучени до этого. Лучший результат у Ridge + OneHotEncoding + best alpha: 0.253

В ходе проведения работы удалось:
1) Обработать данные удалив дубли и заполнив пропуски медианными значениями
2) Применить OHE для столбца seats
3) Обучить линейную регрессию с L1, L2 и L1 и L2 регулизацией.
4) Сделать кастомную бизнесс метрику

В ходе проведения работы не удалось:
1) Получить модель с точными предсказаниями. Возможные причины:
- Нет предобработки названия машины. При схожих числовых параметрах (мощность, километраж, год выпуска) стоимость модели/марок может сильно отличаться (BMW дороже Kia, а BMW m5 дороже BMW 3)
- Не обработаны выбросы (есть стоимость машин 10 000 000, что является или выбросом или уникальным значением, так же есть выбросы по пробегу)
- Использовали для обучения Linear Regression у которой loss function = MSE. Возможно, с такими выбросами как у нас лучше подошла бы MAE в качестве loss function
